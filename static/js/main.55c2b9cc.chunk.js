(this["webpackJsonptaxi-app"]=this["webpackJsonptaxi-app"]||[]).push([[0],{59:function(e,a,t){e.exports=t(70)},64:function(e,a,t){},69:function(e,a,t){},70:function(e,a,t){"use strict";t.r(a);var r=t(0),n=t.n(r),o=t(7),c=t.n(o),i=(t(64),t(12)),d=t(102),l=t(107),s=t(108),u=t(110),m=t(106),f=(t(69),t(111)),v={code:0,descr:"OK",data:{crews_info:[{crew_id:123,car_mark:"Chevrolet",car_model:"Lacetti",car_color:"\u0441\u0438\u043d\u0438\u0439",car_number:"\u0415234\u041a\u0423",driver_name:"\u0414\u0435\u0442\u043e\u0447\u043a\u0438\u043d",driver_phone:"7788",lat:56.855532,lon:53.217462,distance:300},{crew_id:125,car_mark:"Hyundai",car_model:"Solaris",car_color:"\u0431\u0435\u043b\u044b\u0439",car_number:"\u0424567\u0410\u0421",driver_name:"\u041f\u0435\u0442\u0440\u043e\u0432",driver_phone:"8899",lat:56.860581,lon:53.209223,distance:1200},{crew_id:126,car_mark:"Chevrolet",car_model:"Aveo",car_color:"\u0441\u0438\u043d\u0438\u0439",car_number:"\u0415234\u041a\u0423",driver_name:"\u0414\u0435\u0442\u043e\u0447\u043a\u0438\u043d",driver_phone:"6688",lat:57.855532,lon:52.217462,distance:400},{crew_id:128,car_mark:"Chevrolet",car_model:"Lanos",car_color:"\u0431\u0435\u043b\u044b\u0439",car_number:"\u0424525\u0410\u0421",driver_name:"\u041f\u0435\u0442\u0440\u043e\u0432\u0438\u0447",driver_phone:"4455",lat:53.860581,lon:51.209223,distance:500}]}},p=function(e){return new Promise((function(e,a){v.code?a(v):e(v)}))};function g(e,a){return{type:"CHANGE_ADDRESS",address:e,withCoord:a}}var b=Object(d.a)({container:{display:"flex",flexWrap:"wrap"},textField:{marginLeft:10,marginRight:10},dense:{marginTop:16},menu:{width:200}});var E=Object(i.b)((function(e){return{address:e.main.address,coord:e.main.coord,isValid:e.main.isValid}}),{changeAddress:g})((function(e){var a=b(),t=!e.isValid&&Boolean(e.address)?"\u0412\u0432\u0435\u0434\u0438\u0442\u0435 \u043a\u043e\u0440\u0440\u0435\u043a\u0442\u043d\u044b\u0439 \u0430\u0434\u0440\u0435\u0441":"";return n.a.createElement("form",{className:a.container,noValidate:!0,autoComplete:"off"},n.a.createElement(f.a,{id:"address",label:"\u041e\u0442\u043a\u0443\u0434\u0430",className:a.textField,value:e.address,onChange:function(a){(0,e.changeAddress)(a.target.value)},margin:"normal",variant:"outlined",error:Boolean(e.address)&&!e.isValid,helperText:t}))})),_=t(30),h=t(37),w=function(e){var a=e.toLowerCase().split(","),t=Object(_.a)(a,2),r=t[0],n=t[1],o=void 0===n?"":n;return/[\u0410-\u042f\u0430-\u044f\u0451\u04010-9\-\\s\\.\\/]+$/.test(r.trim())&&/^[0-9][\u0410-\u042f\u0430-\u044f\u0451\u04010-9\\/]*$/.test(o.trim())};var O=Object(i.b)((function(e){return{address:e.main.address,coord:e.main.coord,isValid:e.main.isValid}}),{setCoord:function(e){return{type:"SET_COORD",payload:e}},changeAddress:g})((function(e){var a=Object(r.useState)(void 0),t=Object(_.a)(a,2),o=t[0],c=t[1],i=Object(r.useState)({name:"",coord:[0,0]}),d=Object(_.a)(i,2),l=d[0],s=d[1],u=Object(r.useRef)(!1),f=function(a){u.current=!0,null===o||void 0===o||o.geocode(a).then((function(t){if(u.current=!1,"string"===typeof a){var r,n,o;(0,e.setCoord)(null===t||void 0===t||null===(r=t.geoObjects)||void 0===r||null===(n=r.get(0).properties)||void 0===n||null===(o=n.getAll())||void 0===o?void 0:o.boundedBy[0])}else{var c,i,d,l,s=e.changeAddress,m=null===t||void 0===t||null===(c=t.geoObjects)||void 0===c||null===(i=c.get(0))||void 0===i||null===(d=i.properties)||void 0===d||null===(l=d.getAll())||void 0===l?void 0:l.name;s(w(m)?m:"",!0)}})).catch((function(e){return console.log(e)}))};return Object(r.useEffect)((function(){var a=e.coord,t=e.address,r=e.isValid;!u.current&&!a&&o&&t&&r&&f("".concat(l.name,",").concat(t))}),[e.coord,e.address,e.isValid,o]),n.a.createElement(n.a.Fragment,null,!Boolean(o)&&n.a.createElement(m.a,{variant:"subtitle2",gutterBottom:!0},"\u041a\u0430\u0440\u0442\u0430 \u0437\u0430\u0433\u0440\u0443\u0436\u0430\u0435\u0442\u0441\u044f...."),n.a.createElement("div",{className:Boolean(o)?"":"not-visible"},n.a.createElement(h.c,{query:{apikey:"2472381c-4de4-437c-920e-8c2ade2afc26"}},n.a.createElement("div",null,n.a.createElement(h.a,{state:{center:e.coord||l.coord,zoom:16},modules:["geolocation","geocode"],onLoad:function(e){c(e),function(e){return e.geolocation.get({provider:"yandex",mapStateAutoApply:!0})}(e).then((function(e){s({name:e.geoObjects.get(0).properties.getAll().name,coord:e.geoObjects.position})}))},onClick:function(a){var t=e.setCoord,r=a.get("coords");t(r),f(r)}},Boolean(e.coord)&&n.a.createElement(h.b,{options:{preset:"islands#icon",iconColor:e.isValid?"yellow":"red"},properties:{iconCaption:e.isValid?"":"\u0410\u0434\u0440\u0435\u0441 \u043d\u0435 \u043d\u0430\u0439\u0434\u0435\u043d"},geometry:e.coord}))))))})),C=t(112),j=Object(d.a)({root:{display:"flex",alignItems:"center",maxWidth:250},h:{marginBottom:10},container:{margin:20}});var y=function(e){var a=j();return n.a.createElement(l.a,{className:a.root},n.a.createElement(s.a,null,n.a.createElement(m.a,{variant:"caption",component:"span"},e.car_mark),n.a.createElement(m.a,{color:"textSecondary"},e.car_color),n.a.createElement(C.a,{variant:"outlined",size:"medium",color:"primary"},e.car_number)))},S=t(51),x=t(49),V=Object(x.a)((function(e){var a;return null===(a=e.main.findedCrew)||void 0===a?void 0:a.data}),(function(e){return e&&e.crews_info?Object(S.a)(e.crews_info).sort((function(e,a){return e.distance-a.distance})):[]})),A=Object(d.a)({root:{display:"flex",alignItems:"center",maxWidth:250},h:{marginBottom:10},container:{margin:20},icon:{width:20,marginLeft:10}});var B=Object(i.b)((function(e){return{findedCrew:V(e)}}))((function(e){var a=A();return e.findedCrew&&e.findedCrew.length?n.a.createElement("div",{className:a.container},n.a.createElement(m.a,{className:a.h,variant:"h6",component:"h3"},"\u041f\u043e\u0434\u0445\u043e\u0434\u044f\u0449\u0438\u0439 \u044d\u043a\u0438\u043f\u0430\u0436"),n.a.createElement(y,e.findedCrew[0])):null})),N=t(19),k={address:"",coord:void 0,isValid:!1,findedCrew:null,sendOrder:""};var R=t(23),D=t(50),W=Object(R.c)({main:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:k,a=arguments.length>1?arguments[1]:void 0;switch(a.type){case"CHANGE_ADDRESS":return Object(N.a)(Object(N.a)({},e),{},{address:a.address,coord:a.withCoord?e.coord:void 0,isValid:w(a.address),findedCrew:null});case"SET_COORD":return Object(N.a)(Object(N.a)({},e),{},{coord:a.payload});case"SET_CREWS":return Object(N.a)(Object(N.a)({},e),{},{findedCrew:a.payload});default:return e}}}),F=Object(R.d)(W,Object(R.a)(D.a)),L=function(){var e=new Date;return e.getFullYear().toString()+T(e.getMonth()+1,2)+T(e.getDate(),2)+T(e.getHours(),2)+T(e.getMinutes(),2)+T(e.getSeconds(),2)},T=function(e,a){for(var t=""+e;t.length<a;)t="0"+t;return t},H=Object(d.a)({root:{display:"flex",padding:"0 10px 0 0",alignItems:"center",justifyContent:"space-between",width:250,borderRadius:0,borderBottom:"1px solid #000"},h:{marginBottom:10},container:{margin:0,padding:"8px 10px"}});var I=function(e){var a=H();return n.a.createElement(l.a,{className:a.root},n.a.createElement(s.a,{className:a.container},n.a.createElement(m.a,{variant:"caption",component:"span"},e.car_mark),n.a.createElement(m.a,{color:"textSecondary"},e.car_color)),n.a.createElement(m.a,{color:"textSecondary"},e.distance," m"))};var z=Object(i.b)((function(e){return{address:e.main.address,coord:e.main.coord,isValid:e.main.isValid,findedCrew:e.main.findedCrew,crewSort:V(e)}}),{getFindedCrew:function(e){return function(e){p().then((function(a){e({type:"SET_CREWS",payload:a})}))}}})((function(e){if(Object(r.useEffect)((function(){var a=e.coord,t=e.address,r=e.isValid,n=e.getFindedCrew;a&&t&&r&&n({source_time:L(),addresses:[{address:t,lat:a[0],lon:a[1]}]})}),[e.coord,e.address,e.isValid]),!e.findedCrew)return null;var a=e.crewSort&&e.crewSort.length?e.crewSort:void 0;return n.a.createElement(l.a,null,0!==e.findedCrew.code&&"\u0412\u043e\u0437\u043d\u0438\u043a\u043b\u0438 \u043e\u0448\u0438\u0431\u043a\u0438 \u043f\u0440\u0438 \u043f\u043e\u043b\u0443\u0447\u0435\u043d\u0438\u0438 \u0434\u0430\u043d\u043d\u044b\u0445 ".concat(e.findedCrew.descr),null===a||void 0===a?void 0:a.map((function(e){return n.a.createElement(I,Object.assign({key:e.crew_id},e))})))})),M=t(109);var G=Object(i.b)((function(e){return{coord:e.main.coord,address:e.main.address,isValid:e.main.isValid,findedCrew:V(e)}}),{sendOrder:function(e){return function(e){p().then((function(a){e({type:"SEND_ORDER",payload:a.descr})}))}}})((function(e){return n.a.createElement(M.a,null,n.a.createElement(C.a,{size:"small",onClick:function(){var a=e.address,t=e.isValid,r=e.coord,n=e.sendOrder,o=e.findedCrew,c=o&&o.length?o[0]:void 0;t&&r&&c&&n({source_time:L(),addresses:[{address:a,lat:r[0],lon:r[1]}],crew_id:c.crew_id})},disabled:!e.isValid},"\u0417\u0430\u043a\u0430\u0437\u0430\u0442\u044c"))})),J=Object(d.a)({root:{minWidth:600},container:{display:"flex"}});var $=function(){var e=J();return n.a.createElement(i.a,{store:F},n.a.createElement(l.a,{className:e.root,variant:"outlined"},n.a.createElement(s.a,null,n.a.createElement(m.a,{variant:"h5",component:"h2",color:"textSecondary",gutterBottom:!0},"\u0414\u0435\u0442\u0430\u043b\u0438 \u0437\u0430\u043a\u0430\u0437\u0430"),n.a.createElement(u.a,{variant:"fullWidth"}),n.a.createElement(E,null),n.a.createElement(B,null),n.a.createElement("div",{className:e.container},n.a.createElement(O,null),n.a.createElement(z,null))),n.a.createElement(G,null)))};c.a.render(n.a.createElement(n.a.StrictMode,null,n.a.createElement($,null)),document.getElementById("root"))}},[[59,1,2]]]);
//# sourceMappingURL=main.55c2b9cc.chunk.js.map